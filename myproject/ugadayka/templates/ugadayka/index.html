{% extends 'ugadayka/base.html' %}
{% load mathfilters %}

{% block content %}
    {% if user.is_authenticated %}
        <div class="game-container">
            {% if not game_data.attempt_used and next_attempt_available %}
                <h2>–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 100</h2>
                <form method="post" class="game-form">
                    {% csrf_token %}
                    <input type="number" name="number" min="1" max="100" required class="number-input">
                    <button type="submit" class="lucky-button">–ú–Ω–µ –ø–æ–≤–µ–∑—ë—Ç!</button>
                </form>
            {% else %}
                {% if game_data.guessed %}
                    <div class="message success">
                        <h2>üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</h2>
                        <p>–í—ã —É–≥–∞–¥–∞–ª–∏ —á–∏—Å–ª–æ {{ game_data.secret_number }}!</p>
                        <div class="reward">
                            <p>–í –í–∞—à –∫–æ—à–µ–ª–µ–∫ –í–ö–æ–Ω—Ç–∞–∫—Ç–µ –Ω–∞—á–∏—Å–ª–µ–Ω—ã <strong>{{ game_data.current_win }} –£–≥–∞–¥–∞–π–∫–æ–∏–Ω–æ–≤</strong>.</p>
                            <p>(1 –£–≥–∞–¥–∞–π–∫–æ–∏–Ω = 1 —Ä—É–±–ª—å)</p>
                        </div>
                        <p>–û–±—â–∏–π –≤—ã–∏–≥—Ä—ã—à: {{ game_data.total_coins }} –£–≥–∞–¥–∞–π–∫–æ–∏–Ω–æ–≤</p>
                    </div>
                {% else %}
                    <div class="message error">
                        <h2>üò¢ –ù–µ —É–≥–∞–¥–∞–ª–∏</h2>
                        <p>–ë—ã–ª–æ –∑–∞–≥–∞–¥–∞–Ω–æ —á–∏—Å–ª–æ <strong>{{ game_data.secret_number }}</strong></p>
                        {% if game_data.user_number %}
                            <p>–í—ã –≤–≤–µ–ª–∏: <strong>{{ game_data.user_number }}</strong></p>
                        {% endif %}
                        <p>–í–æ–∑–º–æ–∂–Ω–æ, –í–∞–º –ø–æ–≤–µ–∑—ë—Ç –≤ –¥—Ä—É–≥–æ–π —Ä–∞–∑.</p>
                    </div>
                {% endif %}

                {% if not next_attempt_available %}
                    <div class="timer">
                        –°–ª–µ–¥—É—é—â–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑: <span id="countdown">{{ remaining_seconds|intdiv:60 }}:{{ remaining_seconds|mod:60|stringformat:"02d" }}</span>
                    </div>
                {% else %}
                    <a href="?reset=true" class="try-again-button">–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞</a>
                {% endif %}
            {% endif %}
        </div>
    {% endif %}
{% endblock %}